(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{525:function(e,t,r){"use strict";r.r(t);r(521);var n=r(516),a=(r(104),r(61)),o=r(164),c=r(45),l=r(59),s=r(65),i=r(64),p=r(16),u=r.n(p),d=r(0),h=r.n(d),m=r(57),f=r(9),O=r(152),v=(r(149),r(108)),b=(r(406),r(403)),g=(r(219),r(384)),x=r(196),j=r(6),y=r(392),k=r.n(y),E=r(416),S=r.n(E),C=r(417),w=r.n(C),T=r(428),F=r(117),A=r(527),D=r(528),I=r(526),N=r(529),P=r(50),q=(r(429),r(519)),R=q.a.TreeNode;var K=function(e){Object(s.a)(r,e);var t=Object(i.a)(r);function r(){return Object(c.a)(this,r),t.apply(this,arguments)}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.className,r=e.columns,n=e.value,a=e.onChange,o=void 0===a?function(){}:a;return h.a.createElement("div",{className:t},h.a.createElement(b.a,{title:"\u663e\u793a\u7684\u6570\u636e\u9879",bodyStyle:{padding:5},hoverable:!0},h.a.createElement(q.a,{checkable:!0,defaultCheckedKeys:n,onCheck:o,selectable:!1},function e(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map(function(t){var r=t.title,n=t.key,a=t.children,o=t.frozen;return h.a.createElement(R,{title:r,key:n,disableCheckbox:o},a&&e(a))})}(r))))}}]),r}(d.PureComponent),G=(r(396),r(404)),L=(r(151),r(94)),B=(r(383),r(386)),M=(r(466),r(518)),U=(r(468),r(407)),z=r(10),H="DOING",J="TODO",X=10;function _(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],r=[],n=Object(x.a)(t);try{for(n.s();!(e=n.n()).done;){var a=e.value;a.hidden||(r.push(a.key),r=r.concat(_(a.children)))}}catch(o){n.e(o)}finally{n.f()}return r}function Q(e){return k()(e)?"--":e}var V,W=function(){return{payload:{},meta:{types:{}}}},Y=Object(P.a)(v.a)(["margin-right:5px;color:#595959;:hover{cursor:pointer;color:#262626;}"]),Z=r(77),$=r(76);r.d(t,"default",function(){return ce});var ee=$.a.store.pets,te=Z.c.makeListPets(ee),re=Z.c.makeCreatePet("nobody",{},{parallel:!0}),ne=$.a.store.refresh,ae=Object(f.m)(ne),oe=Object(f.n)(ne),ce=Object(f.B)(Object(f.w)(ne,u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(f.v)(te());case 2:case"end":return e.stop()}},e)})))(V=Object(m.connect)(function(e){return{cron:oe(e)}})(V=Object(O.a)("Pet-Store")(V=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.SearchForm,n=t.total,p=void 0===n||n,d=(t.refresh,t.filter),O=void 0===d||d,v=t.exporter,x=void 0===v||v,y=t.importer,k=void 0!==y&&y,E=t.title,C=t.columns,P=t.fetchOnMount,q=void 0===P||P,R=t.create,V=void 0===R?W:R,Z=t.list,$=void 0===Z?W:Z,ee=t.makeListSelector,te=t.makeXlsxSelector;return function(t){var n="".concat(e,"Exporter"),d="".concat(e,"Importer"),v=C.map(function(e){return Object(j.a)({render:Q},e)}),y=Object(F.a)(e,{columns:v.filter(function(e){return Boolean(e.dataIndex)||!S()(e.children)})}),P=Object(F.b)(e),R=Object(f.i)(e);ee&&(R=ee(R));var W=Object(f.i)(n);ee&&(W=ee(W)),te&&(P=te(P));var Z=function(e,t){var r,n=t.title,a=t.xlsxSelector,o=t.xlsxActions,p=t.list,u=t.listSelector;return Object(m.connect)(function(e){return{listState:u(e),xlsx:a(e)}})(r=function(e){Object(s.a)(r,e);var t=Object(i.a)(r);function r(){var e;Object(c.a)(this,r);for(var a=arguments.length,l=new Array(a),s=0;s<a;s++)l[s]=arguments[s];return(e=t.call.apply(t,[this].concat(l))).handleCancel=function(){e.props.onToggle&&e.props.onToggle()},e.handleOk=function(){var t=e.props,r=t.columns,a=void 0===r?[]:r,c=t.listState,l=(void 0===c?{}:c).result;e.props.onToggle&&e.props.onToggle(),e.props.dispatch(o.export({name:n,type:"xlsx",rows:l},{columns:a}))},e}return Object(l.a)(r,[{key:"componentDidMount",value:function(){this.props.dispatch(p(this.props.request))}},{key:"render",value:function(){var e=this.props.listState,t=e.loading,r=e.result,a=this.props.xlsx.exporting;return h.a.createElement(G.a,{title:"\u5bfc\u51fa - ".concat(n),visible:!0,onOk:this.handleOk,okText:"\u5bfc\u51fa",confirmLoading:t||a,onCancel:this.handleCancel,width:800},t?h.a.createElement("p",null,"\u6b63\u5728\u51c6\u5907\u6570\u636e... "):h.a.createElement("div",null," ","\u4e0b\u8f7d\u9009\u4e2d\u7684".concat(r.length,"\u6761\u8bb0\u5f55")," "))}}]),r}(h.a.Component))||r}(0,{title:E,list:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0,r=$(e,t);return r.key=n,r.payload.query=Object(j.a)(Object(j.a)({},e.query),{},{limit:5e3}),r},listSelector:W,xlsxSelector:P,xlsxActions:y}),re=function(e,t){var r,n=t.title,o=t.create,p=t.xlsxActions,d=t.xlsxSelector,O=o().meta.types,v=o().key,b=Object(f.m)(e),g=Object(f.n)(e),x=Object(f.o)(e),y=Object(f.p)(e);return Object(f.B)(Object(f.w)(e,u.a.mark(function e(t){var r,n;return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=t.payload.pos,e.next=3,Object(z.g)(d);case 3:return n=e.sent,e.next=6,Object(z.f)(o({body:n.result[r-1]}));case 6:case"end":return e.stop()}},e)})),Object(f.x)(O.SUCCESS,v,u.a.mark(function e(t){return u.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(z.f)(x.increase());case 2:case"end":return e.stop()}},e)})),Object(f.x)(O.FAILURE,v,function(){Object(U.b)("Failed to import")}))(r=Object(m.connect)(function(e){var t=d(e);return{cron:g(e),xlsx:t,progress:y(e)}})(r=function(e){Object(s.a)(r,e);var t=Object(i.a)(r);function r(){var e;Object(c.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).state={fileReady:!1,step:J},e.close=function(){e.props.dispatch(b.stop()),e.props.dispatch(b.reset()),e.props.onToggle&&e.props.onToggle()},e.upload=function(){var t=e.props.xlsx.result.length;e.props.dispatch(b.start({max:t,pos:0,interval:500})),e.props.dispatch(x.reset({max:t,pos:0})),e.setState({step:H})},e.selectFile=function(t){return e.setState({fileReady:!0}),e.props.dispatch(p.import({file:t})),e.props.dispatch(x.reset({max:100,pos:0})),!1},e.OkText={TODO:"\u5f00\u59cb\u5bfc\u5165",DOING:"\u5bfc\u5165\u4e2d...",DONE:"\u5b8c\u6210"},e.HandleOk={TODO:e.upload,DONE:e.close},e}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props.progress,t=this.state,r=t.fileReady,o=t.step,c=this.OkText[o],l=this.HandleOk[o];return h.a.createElement(G.a,{title:"\u5bfc\u5165 - ".concat(n),visible:!0,onOk:l,okButtonProps:{disabled:!r},okText:c,confirmLoading:o===H,onCancel:this.close,width:800},h.a.createElement(M.a,{beforeUpload:this.selectFile},h.a.createElement(a.a,null,h.a.createElement(I.a,null)," Select Excel File")),r&&h.a.createElement(L.a,{style:{marginTop:30}},h.a.createElement(B.a,{percent:Math.floor(e.pos/e.max*100)})))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var r=e.progress;return t.step===H&&r.max===r.pos?Object(j.a)(Object(j.a)({},t),{},{step:"DONE"}):null}}]),r}(h.a.Component))||r)||r}(d,{title:E,create:V,xlsxActions:y,xlsxSelector:P}),ne=function(e){Object(s.a)(a,e);var n=Object(i.a)(a);function a(){var e;Object(c.a)(this,a);for(var t=arguments.length,r=new Array(t),o=0;o<t;o++)r[o]=arguments[o];return(e=n.call.apply(n,[this].concat(r))).state={exporterOpen:!1,importerOpen:!1,checkedKeys:_(v)},e.handleRefresh=function(){var t=e.props.listState;e.handleFetch(t.request)},e.handleFetch=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Object(j.a)(Object(j.a)({},w()(e.props,"listState.request.query")),{},{_offset:(r-1)*X},t.query);e.props.dispatch($(Object(j.a)(Object(j.a)({},t),{},{query:n})))},e.handleFilterKeys=function(t){e.setState({checkedKeys:t})},e.toggleExporter=function(){e.setState({exporterOpen:!e.state.exporterOpen})},e.toggleImporter=function(){e.setState({importerOpen:!e.state.importerOpen})},e.renderExtra=function(){var t=e.props.listState,r=void 0===t?{}:t;return h.a.createElement("div",null,h.a.createElement("span",{style:{marginRight:24,color:"#595959"}},"\u603b\u8ba1 ",r.total),h.a.createElement("span",null,p&&h.a.createElement(Y,{title:"\u5237\u65b0"},h.a.createElement(A.a,{onClick:e.handleRefresh})),O&&h.a.createElement(g.a,{overlay:h.a.createElement(K,{columns:v,onChange:e.handleFilterKeys,value:e.state.checkedKeys}),trigger:["click"]},h.a.createElement(Y,{title:"\u7b5b\u9009"},h.a.createElement(D.a,null))),k&&h.a.createElement(Y,{title:"\u5bfc\u5165"},h.a.createElement(I.a,{onClick:e.toggleImporter})),x&&h.a.createElement(Y,{title:"\u5bfc\u51fa"},h.a.createElement(N.a,{onClick:e.toggleExporter}))))},e}return Object(l.a)(a,[{key:"render",value:function(){var e=this.props,n=e.table,a=e.listState,c=e.className,l=Object(o.a)(e,["table","listState","className"]),s=function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];if(t)return t.map(function(t){var n=e(t.children,r);return n?Object(j.a)(Object(j.a)({},t),{},{children:n}):t}).filter(function(e){return r.includes(e.key)||!S()(e.children)})}(v,this.state.checkedKeys);return h.a.createElement("div",{className:c},r&&h.a.createElement(r,{onFetch:this.handleFetch}),h.a.createElement(b.a,{title:E,extra:this.renderExtra()},h.a.createElement(t,Object.assign({},n,{columns:s},l)),this.state.exporterOpen&&h.a.createElement(Z,{onToggle:this.toggleExporter,columns:s,request:a.request}),re&&this.state.importerOpen&&h.a.createElement(re,{onToggle:this.toggleImporter})))}}]),a}(h.a.PureComponent);return Object(T.createTable)(e,{defaultPageSize:X,columns:v,list:$,listSelector:R,fetchOnMount:q})(ne)}}(ee,{title:"Pets in Store",columns:[{title:"name",dataIndex:"name",key:"name",sorter:!0},{title:"Pet's  owner and tag",children:[{title:"owner",dataIndex:"owner",key:"owner"},{title:"tag",dataIndex:"tag",key:"tag",filters:[{text:"CAT",value:"CAT"},{text:"DOG",value:"DOG"}]}]},{title:"age",dataIndex:"age",key:"age",sorter:!0,hidden:!0}],create:re,list:te,importer:!0})(V=function(e){Object(s.a)(r,e);var t=Object(i.a)(r);function r(){var e;Object(c.a)(this,r);for(var n=arguments.length,a=new Array(n),o=0;o<n;o++)a[o]=arguments[o];return(e=t.call.apply(t,[this].concat(a))).startCron=function(){return e.props.dispatch(ae.start({interval:2e3}))},e.stopCron=function(){return e.props.dispatch(ae.stop())},e.resetCron=function(){return e.props.dispatch(ae.reset())},e}return Object(l.a)(r,[{key:"render",value:function(){var e=this.props,t=e.cron,r=Object(o.a)(e,["cron"]);return h.a.createElement(h.a.Fragment,null,h.a.createElement(a.a.Group,null,t.running?h.a.createElement(a.a,{onClick:this.stopCron,type:"danger"},"Auto refresh Stop"):h.a.createElement(a.a,{type:"primary",onClick:this.startCron},"Auto refresh Start"),h.a.createElement(a.a,{onClick:this.resetCron},"Reset")),h.a.createElement(n.a,r))}}]),r}(h.a.PureComponent))||V)||V)||V)||V}}]);
//# sourceMappingURL=8.98673cd0.chunk.js.map